<%- include header %>
<section id="main">
    <div class="container">
        <div class="row">
            <div class="col-md-8 col-md-offset-2" style="margin-top:20px;">
                <div class="well" style="padding-left:0px;padding-right:0px;padding-bottom:0px;">
                    <div class="col-md-13 col-md-offset-0" style="margin-top:20px;margin-bottom:20px;margin-left:40px;">
                        <h1><%= doc.name %></h1>
                        <!-- <p>請完成以下題目</p>
                            <h3><a title="編輯" href="/txt/<%= title %>" > 編輯 </a></h3>
                            <p class="text-danger">*必填</p> -->
                    </div>

                    <% doc.choice.forEach(function(type, index, array){ %>
                    <div class="col-md-13 col-md-offset-0" id="container<%= index %>" style="padding:25px 45px 5px 45px"  onmousedown="sectionFocus(<%= index %>)">

                        <!-- <div class="container" id="container<%= index %>"> -->
                            <form action="/testsave" method="post" id="form<%= index %>">
                                <fieldset>

                                    <div style="float:right;">
                                        <div class="btn-group" id="dropdown<%= index %>" style="display:none">
                                            <button class="btn btn-raised dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="false" aria-expanded="false">題目類型</button>
                                            <ul class="dropdown-menu">
                                                <li><a href="">單選</a></li>
                                                <li><a href="">多選</a></li>
                                              </ul>
                                            <!-- <div class="dropdown-menu">
                                                <a class="dropdown-item" href="#">Action</a>
                                                <a class="dropdown-item" href="#">Another action</a>
                                                <a class="dropdown-item" href="#">Something else here</a>
                                                <div class="dropdown-divider"></div>
                                                <a class="dropdown-item" href="#">Separated link</a>
                                            </div> -->
                                        </div>
                                    </div>
                                    <br><br>
                                    <div id="title<%= index %>" style="clear:both;">
                                        <strong>
                                            <h4 onclick="edit(<%= index %>)"><%= doc.post.test[ index ] %></h4>
                                        </strong>
                                    </div>
                                    <div class="form-group" style="margin-top:10px;">
                                        <textarea id="title-edit<%= index %>" name="post" rows="1" class="form-control" style="overflow:hidden;width:80%;height:auto;display:none" onfocus="sectionFocus(<%= index %>)"> <%= doc.post.test[ index ] %> </textarea>
                                    </div>

                                    <!-- <br/> -->

                                    <%for(var i =0;i < type.length; i++){%>

                                    <div class="form-group" style="margin-top:10px;">
                                        <div >
                                            <h4><%= sum %></h4>
                                        </div>

                                        <% var option = doc.post.choice[index][i]; %>
                                        <% Object.keys(option).forEach(function(key,optionindex) { %>

                                            <% if(type[i] == 'single' ){ %>
                                                <div class="media" style="margin-top:5px;">
                                                <div class="media-left media-middle" style="width:100%;padding:15px 20px 0px 5px;" >
                                                    <div class="radio radio-primary" style="margin:0px 0px 0px 0px">
                                                        <label style="width:100%;">
                                                        <input type="radio" name="<%= sum %>" value="<%= key %>" id="<%= sum %><%= key %>">
                                                        <textarea name = "<%= key %>" class="form-control" rows="1" style="margin-bottom:0px;" id="optionedit<%= sum %><%= key %>"> <%= doc.post.choice[ index ][i][key] %> </textarea>
                                                        <h4 style="margin:0px" onclick="editOption(<%= sum %><%= key %>)" id="option<%= sum %><%= key %>"><%= doc.post.choice[ index ][i][key] %></h4>
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="media-body media-middle">
                                                    <button type="button" onclick="removeOneOption('<%= doc.name%>',<%= index%>,<%= i%>,<%= optionindex %>)" aria-hidden="true" class="close" style="font-size:30px;">×</button>
                                                </div>
                                            </div>



                                            <% } else if (type[i] == 'multiple' ){ %>
                                                <div class="media" style="margin-top:5px;">
                                                    <div class="media-left media-middle" style="width:100%;padding:15px 20px 0px 5px;" >
                                                <div class="checkbox">
                                                    <label id="check">
                                                        <input type="checkbox" style="padding-right:5px">
                                                        <span id="check-item">
                                                            <!-- A<%= doc.post.choice[ index ][i][key] %> -->
                                                        </span>
                                                        <textarea name = "<%= key %>" class="form-control" rows="1" onfocus="sectionFocus(<%= index %>)"> <%= doc.post.choice[ index ][i][key] %> </textarea>
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="media-body media-middle">
                                                <button type="button" onclick="removeOneOption('<%= doc.name%>',<%= index%>,<%= i%>)" aria-hidden="true" class="close" style="font-size:30px;">×</button>
                                            </div>
                                            </div>
                                            <% } %>
                                        <% }) %>
                                        <button onclick="removeText(<%= index%>,<%= i%>,'<%= doc.name%>')" type="button" class="btn btn-default">刪除</button>
                                        <button onclick="insertOption('<%= doc.name%>',<%= index%>,<%= i%>)" type="button" class="btn btn-default">新增選項</button>
                                        <% sum = sum +1; %>
                                        <% } %>

                                        <div id="btn-group-<%= index %>" style="display:none;margin-top:15px;" onfocusout="sectionFocusOut(<%= index %>)">

                                            <button onclick="removeall('<%= doc.name%>',<%= index%>)" type="button" class="btn btn-default" id="btn-<%= sum %>">刪除此題</button>
                                            <button onclick="insert('<%= doc.name%>',<%= index%>)" type="button" class="btn btn-default" id="btn-<%= sum %>">新增下一題</button>
                                            <button onclick="single(<%= index%>,'<%= doc.name%>')" type="button" class="btn btn-default" id="btn-<%= sum %>">新增單選</button>
                                            <button onclick="multiple(<%= index%>,'<%= doc.name%>')" type="button" class="btn btn-default" id="btn-<%= sum %>">新增多選</button>
                                            <button class="btn btn-default" id="btn-<%= sum %>" type="button" onclick="formData(<%= index %>,'<%= doc.name %>')">儲存變更</button>
                                        </div>
                                    </div>
                                </fieldset>
                            </form>
                        </div>
                    <!-- <hr> -->
                    <% }) %>
                </div>
            </div>
        </div>
    </div>
</section>
<%- include footer %>
